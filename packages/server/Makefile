# ğŸš€ Makefile â€” Project Manager Server (Slice Standard)
# Comandos universais para automaÃ§Ã£o, build, testes e Docker

PROJECT_NAME ?= server
REGISTRY ?= <seu-registry>
IMAGE ?= $(REGISTRY)/$(PROJECT_NAME):latest

.PHONY: prepare install dev serve clean build format lint test test-e2e docker-build docker-push help

prepare:
	@echo "ğŸ”§ Preparando ambiente do projeto..."
	# Adicione comandos de preparaÃ§Ã£o aqui (ex: copiar .env.example, checar prÃ©-requisitos)

install:
	@echo "ğŸ“¦ Instalando dependÃªncias..."
	pnpm install || npm install || yarn install

dev:
	@echo "ğŸš€ Iniciando em modo desenvolvimento..."
	pnpm run dev || npm run dev || yarn dev

serve:
	@echo "ğŸŒ Iniciando em modo produÃ§Ã£o..."
	pnpm run start || npm run start || yarn start

clean:
	@echo "ğŸ§¹ Limpando dependÃªncias, caches e arquivos temporÃ¡rios..."
	rm -rf node_modules dist .turbo .next .cache coverage .eslintcache

build:
	@echo "ğŸ—ï¸  Realizando build do projeto..."
	pnpm run build || npm run build || yarn build

format:
	@echo "ğŸ¨ Formatando cÃ³digo-fonte..."
	pnpm run format || npm run format || yarn format

lint:
	@echo "ğŸ” Rodando linter..."
	pnpm run lint || npm run lint || yarn lint

test:
	@echo "ğŸ§ª Executando testes unitÃ¡rios..."
	pnpm run test || npm run test || yarn test

test-e2e:
	@echo "ğŸ§ªğŸ”— Executando testes end-to-end..."
	pnpm run test:e2e || npm run test:e2e || yarn test:e2e

docker-build:
	@echo "ğŸ³ Buildando imagem Docker..."
	docker build -t $(IMAGE) .

docker-push:
	@echo "ğŸ“¦ Enviando imagem Docker para o registry..."
	docker push $(IMAGE)

help:
	@echo "\nComandos disponÃ­veis para $(PROJECT_NAME):\n"
	@echo "  ğŸ”§ prepare      â€” Prepara o projeto para instalaÃ§Ã£o"
	@echo "  ğŸ“¦ install      â€” Instala todas as dependÃªncias"
	@echo "  ğŸš€ dev          â€” Executa em modo desenvolvimento"
	@echo "  ğŸŒ serve        â€” Executa em modo produÃ§Ã£o"
	@echo "  ğŸ§¹ clean        â€” Limpa dependÃªncias, caches e temporÃ¡rios"
	@echo "  ğŸ—ï¸  build        â€” Realiza o build do projeto"
	@echo "  ğŸ¨ format       â€” Formata o cÃ³digo-fonte"
	@echo "  ğŸ” lint         â€” Valida o cÃ³digo com linter"
	@echo "  ğŸ§ª test         â€” Executa testes unitÃ¡rios"
	@echo "  ğŸ§ªğŸ”— test-e2e     â€” Executa testes de integraÃ§Ã£o/end-to-end"
	@echo "  ğŸ³ docker-build â€” Builda a imagem Docker"
	@echo "  ğŸ“¦ docker-push  â€” Envia a imagem Docker para o registry"
	@echo "  ğŸ†˜ help         â€” Mostra esta ajuda"
